import{z as e,u as r}from"./data-vendor-DKnsUd_z.js";import{n as s,j as l,X as a,G as o,y as i,t,v as n,o as c,Y as d,B as h,M as m,P as p,$ as g,T as u,V as x,A as y,a0 as j,l as f}from"./mantine-core-BHR5fWID.js";import{u as k}from"./index-DSYVc5nJ.js";import{f as w,k as b,l as v,j as C,m as S,n as z}from"./icons-B2NvWKa5.js";import{r as F}from"./react-vendor-Dbzhzy_A.js";const D=e.object({spellName:e.string(),complexity:e.string().or(e.number()),flare:e.string().or(e.number()),range:e.string(),target:e.string(),action:e.string(),duration:e.string(),keywords:e.string(),check:e.string(),spellClass:e.string(),school:e.string(),skill:e.string(),focus:e.string(),spellType:e.string(),description:e.string(),altDescription:e.string().or(e.null())}),T=e.array(D);async function E(){const e=await fetch("/spells.json");if(!e.ok)throw new Error("Failed to fetch spells");return r=await e.json(),T.parse(r);var r}function N(){return r({queryKey:["spells"],queryFn:E})}function A({spell:e,onViewDetails:r,onAddToSpellbook:m,onRemoveFromSpellbook:p,showRemoveButton:g=!1}){const{colors:u}=k(),{colorScheme:x}=s(),y="dark"===x,j={borderRadius:`${u.borderRadius}px`,fontSize:`${u.fontScale}rem`,border:"1px solid "+(y?"var(--mantine-color-dark-4)":"var(--mantine-color-gray-3)")};return l.jsxs(a,{withBorder:!0,shadow:"sm",padding:"md",radius:"md",style:j,bg:y?"dark.6":"white",children:[l.jsx(a.Section,{withBorder:!0,inheritPadding:!0,py:"xs",bg:y?"dark.7":u.primaryColor,children:l.jsxs(o,{justify:"space-between",children:[l.jsx(i,{fw:700,c:"white",children:e.spellName}),l.jsxs(o,{gap:5,children:[l.jsx(t,{label:"View Details",children:l.jsx(n,{variant:"subtle",color:y?"blue.4":"blue.6",onClick:()=>r(e),children:l.jsx(w,{size:16})})}),m&&l.jsx(t,{label:"Add to Spellbook",children:l.jsx(n,{variant:"subtle",color:y?"green.4":"green.6",onClick:()=>m(e),children:l.jsx(b,{size:16})})}),g&&p&&l.jsx(t,{label:"Remove from Spellbook",children:l.jsx(n,{variant:"subtle",color:y?"red.4":"red.6",onClick:()=>p(e.spellName),children:l.jsx(v,{size:16})})})]})]})}),l.jsxs(c,{mt:"md",gap:"xs",children:[l.jsxs(o,{gap:"xs",children:[l.jsx(d,{color:y?"blue.4":"blue.6",size:"sm",children:e.spellClass}),l.jsx(d,{color:y?"teal.4":"teal.6",size:"sm",children:e.school})]}),l.jsxs(h,{children:[l.jsxs(o,{gap:"md",children:[l.jsxs(i,{size:"sm",fw:500,c:y?"gray.3":"dark.8",children:["Complexity: ",e.complexity]}),l.jsxs(i,{size:"sm",fw:500,c:y?"gray.3":"dark.8",children:["Flare: ",e.flare]})]}),l.jsxs(o,{children:[l.jsxs(i,{size:"sm",fw:500,c:y?"gray.3":"dark.8",children:["Range: ",e.range]}),l.jsxs(i,{size:"sm",fw:500,c:y?"gray.3":"dark.8",children:["Target: ",e.target]})]}),l.jsxs(o,{children:[l.jsxs(i,{size:"sm",fw:500,c:y?"gray.3":"dark.8",children:["Action: ",e.action]}),l.jsxs(i,{size:"sm",fw:500,c:y?"gray.3":"dark.8",children:["Duration: ",e.duration]})]}),l.jsx("div",{style:{paddingTop:"0.5rem"},children:l.jsx(i,{size:"sm",fw:500,lineClamp:8,c:y?"gray.1":"dark.9",children:e.description})})]})]})]})}function B({spell:e,opened:r,onClose:a}){const{colors:t}=k(),{colorScheme:n}=s(),h="dark"===n;if(!e)return null;const x={fontSize:`${t.fontScale}rem`};return l.jsx("div",{style:{position:"relative",zIndex:1e3,"--modal-bg-color":h?"#1A1B1E":"white","--modal-text-color":h?"white":"black"},children:l.jsxs(m,{opened:r,onClose:a,title:l.jsx(u,{order:2,c:h?"white":"dark.9",fw:700,children:e.spellName}),size:"lg",overlayProps:{backgroundOpacity:.65,blur:4,color:h?"black":"#e6d9c2"},className:"spell-details-modal","data-dark":h?"true":"false",styles:{header:{backgroundColor:"var(--modal-bg-color)",color:"var(--modal-text-color)",borderBottom:h?"1px solid #2C2E33":"inherit"},content:{backgroundColor:"var(--modal-bg-color)"},close:{color:"var(--modal-text-color)"},body:{padding:0}},children:[l.jsx(p,{p:"md",withBorder:!1,bg:h?"#1A1B1E":"white",style:{backgroundColor:h?"#1A1B1E":"white"},"data-dark":h?"true":"false",className:h?"dark-modal-paper":"",children:l.jsxs(c,{gap:"md",children:[l.jsxs(o,{children:[l.jsx(d,{color:"blue",size:"lg",children:e.spellClass}),l.jsx(d,{color:"teal",size:"lg",children:e.school}),l.jsx(d,{color:"violet",size:"lg",children:e.spellType})]}),l.jsxs(g,{children:[l.jsxs(g.Col,{span:6,children:[l.jsx(i,{fw:700,style:x,c:h?"gray.3":"dark.9",children:"Complexity:"}),l.jsx(i,{style:x,c:h?"white":"dark.8",children:e.complexity})]}),l.jsxs(g.Col,{span:6,children:[l.jsx(i,{fw:700,style:x,c:h?"gray.3":"dark.9",children:"Flare:"}),l.jsx(i,{style:x,c:h?"white":"dark.8",children:e.flare})]}),l.jsxs(g.Col,{span:6,children:[l.jsx(i,{fw:700,style:x,c:h?"gray.3":"dark.9",children:"Range:"}),l.jsx(i,{style:x,c:h?"white":"dark.8",children:e.range})]}),l.jsxs(g.Col,{span:6,children:[l.jsx(i,{fw:700,style:x,c:h?"gray.3":"dark.9",children:"Target:"}),l.jsx(i,{style:x,c:h?"white":"dark.8",children:e.target})]}),l.jsxs(g.Col,{span:6,children:[l.jsx(i,{fw:700,style:x,c:h?"gray.3":"dark.9",children:"Action:"}),l.jsx(i,{style:x,c:h?"white":"dark.8",children:e.action})]}),l.jsxs(g.Col,{span:6,children:[l.jsx(i,{fw:700,style:x,c:h?"gray.3":"dark.9",children:"Duration:"}),l.jsx(i,{style:x,c:h?"white":"dark.8",children:e.duration})]}),l.jsxs(g.Col,{span:12,children:[l.jsx(i,{fw:700,style:x,c:h?"gray.3":"dark.9",children:"Keywords:"}),l.jsx(i,{style:x,c:h?"white":"dark.8",children:e.keywords||"None"})]}),l.jsxs(g.Col,{span:12,children:[l.jsx(i,{fw:700,style:x,c:h?"gray.3":"dark.9",children:"Check:"}),l.jsx(i,{style:x,c:h?"white":"dark.8",children:e.check})]}),l.jsxs(g.Col,{span:12,children:[l.jsx(i,{fw:700,style:x,c:h?"gray.3":"dark.9",children:"Skill:"}),l.jsx(i,{style:x,c:h?"white":"dark.8",children:e.skill})]}),l.jsxs(g.Col,{span:12,children:[l.jsx(i,{fw:700,c:h?"gray.3":"dark.9",children:"Focus:"}),l.jsx(i,{c:h?"white":"dark.8",children:e.focus})]})]}),l.jsxs(c,{gap:"xs",children:[l.jsx(i,{fw:700,c:h?"gray.3":"dark.9",children:"Description:"}),l.jsx(i,{style:{whiteSpace:"pre-wrap"},c:h?"white":"dark.8",children:e.description})]}),e.altDescription&&"-"!==e.altDescription&&"null"!==e.altDescription&&l.jsxs(c,{gap:"xs",children:[l.jsx(i,{fw:700,c:h?"gray.3":"dark.9",children:"Alternative Description:"}),l.jsx(i,{style:{whiteSpace:"pre-wrap"},c:h?"white":"dark.8",children:e.altDescription})]})]})}),"    "]})})}async function R(){const e=await fetch("/spells.tags.json");if(!e.ok)throw new Error("Failed to fetch spell tags");return await e.json()}function $({spells:e,onFilterChange:a}){const[i,t]=F.useState(""),[n,d]=F.useState([]),[h,m]=F.useState([]),[g,u]=F.useState([]),[w,b]=F.useState([0,10]),{colorScheme:D}=s(),{colors:T}=k(),E="dark"===D,{data:N,isLoading:A}=r({queryKey:["spellTags"],queryFn:R}),B=[...new Set(e.map((e=>e.spellClass)))].sort(((e,r)=>e.localeCompare(r))),$=[...new Set(e.map((e=>e.school)))].sort(((e,r)=>e.localeCompare(r))),L=B.map((e=>({value:e,label:e}))),q=$.map((e=>({value:e,label:e}))),P=F.useMemo((()=>{if(!N?.tags)return[];const e=[],r=new Set;Object.entries({"Spell Type":["offensive","defensive","healing","control","utility","aoe","buff","debuff","summoning","transformation","movement"],Elements:["fire","water","air","earth","elemental","fire-damage","electrical-damage","acid-damage","etheric-damage","psychic-damage","disintegration-damage"],"Spell Class":["animism","elementalism","eldritch","sorcery"],Schools:["necromancy","alchemy","telekinesis","hydromancy","aeromancy","pyromancy","geomancy","phytomancy","zoomancy","dreaming"],Targets:["self-target","single-target","burst","aura"],Duration:["instant","sustain","cycles","permanent"],Complexity:["low-complexity","medium-complexity","high-complexity"],Flare:["low-flare","medium-flare","high-flare"],Effects:["psychic-effect","morale-effect","pervasive","corpus-effect","sundering"],Focus:["spirit-focus","manipulate-focus","morphic-focus","ego-focus","formulae-focus","banish-focus"],Conditions:["suffocation","cowed","hallucinating","distracted","dazed","sprawled","immobilized"],Subjects:["animal","plant","spirit","missile","teleport","grapple","environmental","weather","sensory","wall","memory","combat-boost","reaction","lingering"]}).forEach((([s,l])=>{const a=N.tags.filter((e=>l.includes(e.tag))).map((e=>({value:e.tag,label:`${e.name} (${e.matches?.length??0})`,description:e.description})));a.length>0&&(e.push({group:s,items:a}),a.forEach((e=>r.add(e.value))))}));const s=N.tags.filter((e=>!r.has(e.tag))).map((e=>({value:e.tag,label:`${e.name} (${e.matches?.length??0})`,description:e.description})));return s.length>0&&e.push({group:"Other",items:s}),e}),[N]);return F.useEffect((()=>{if(0===e.length)return void a([]);const r=e.filter((e=>{const r=""===i||e.spellName?.toLowerCase().includes(i.toLowerCase())||e.description?.toLowerCase().includes(i.toLowerCase()),s=0===n.length||e.spellClass&&n.includes(e.spellClass),l=0===h.length||e.school&&h.includes(e.school),a="string"==typeof e.complexity?parseInt(e.complexity,10):e.complexity,o=!a||!isNaN(a)&&a>=w[0]&&a<=w[1],t=0===g.length||(N?.tags.some((r=>g.includes(r.tag)&&r.matches?.includes(e.spellName)))??!1);return r&&s&&l&&o&&t}));a(r)}),[i,n,h,w,g,N]),l.jsx(p,{p:"md",radius:T.borderRadius,bg:E?"dark.6":"white",withBorder:!0,children:l.jsxs(c,{gap:"md",children:[l.jsx(x,{placeholder:"Search spells by name or description",value:i,onChange:e=>t(e.currentTarget.value),leftSection:l.jsx(C,{size:16}),rightSection:i?l.jsx(v,{size:16,style:{cursor:"pointer"},onClick:()=>t("")}):null,styles:{input:{backgroundColor:E?"var(--mantine-color-dark-5)":"white",borderColor:E?"var(--mantine-color-dark-4)":"var(--mantine-color-gray-4)"}}}),l.jsx(y,{variant:E?"filled":"default",styles:{item:{borderColor:E?"var(--mantine-color-dark-4)":"var(--mantine-color-gray-3)"},control:{backgroundColor:E?"var(--mantine-color-dark-5)":"white"},panel:{backgroundColor:E?"var(--mantine-color-dark-6)":"white"}},children:l.jsxs(y.Item,{value:"advanced-filters",children:[l.jsx(y.Control,{icon:l.jsx(S,{size:16}),children:"Advanced Filters"}),l.jsx(y.Panel,{children:l.jsxs(c,{gap:"md",children:[l.jsxs(o,{align:"flex-start",children:[l.jsx(j,{label:"Spell Class",placeholder:"Filter by class",data:L,value:n,onChange:d,clearable:!0,style:{flex:1},styles:{input:{backgroundColor:E?"var(--mantine-color-dark-5)":"white",borderColor:E?"var(--mantine-color-dark-4)":"var(--mantine-color-gray-4)"}}}),l.jsx(j,{label:"School",placeholder:"Filter by school",data:q,value:h,onChange:m,clearable:!0,style:{flex:1},styles:{input:{backgroundColor:E?"var(--mantine-color-dark-5)":"white",borderColor:E?"var(--mantine-color-dark-4)":"var(--mantine-color-gray-4)"}}})]}),l.jsx(j,{label:"Tags",placeholder:"Filter by tags",leftSection:l.jsx(z,{size:16}),data:P,value:g,onChange:u,clearable:!0,searchable:!0,maxDropdownHeight:280,disabled:A,styles:{input:{backgroundColor:E?"var(--mantine-color-dark-5)":"white",borderColor:E?"var(--mantine-color-dark-4)":"var(--mantine-color-gray-4)"}}}),l.jsx(o,{justify:"flex-end",children:l.jsx(f,{variant:"outline",onClick:()=>{t(""),d([]),m([]),u([]),b([0,10])},color:E?"blue.4":"blue.6",children:"Reset Filters"})})]})})]})})]})})}export{$ as S,A as a,B as b,N as u};
