import{n as e,j as l,M as s,y as o,p as r,l as a,J as n,o as d,K as t,z as i,L as c,x as p,P as m,T as x,G as h,Q as u}from"./mantine-core-BHR5fWID.js";import{r as j}from"./react-vendor-Dbzhzy_A.js";import{u as b,S as f,a as k,b as g}from"./SpellsFilter-BlsrBEmY.js";import{u as S}from"./useSpellbooks-BQRnh1fI.js";import{n as y}from"./mantine-extras-ebvNXs23.js";import{exportSpellsToPDF as w}from"./pdfExport.enhanced-C6wOpqMx.js";import{c as v,d as C}from"./icons-B2NvWKa5.js";import"./data-vendor-DKnsUd_z.js";import"./index-DSYVc5nJ.js";import"./pdf-vendor-Dox1XW1S.js";function E({spell:n,opened:d,onClose:t}){const{spellbooks:i,addSpellToSpellbook:c}=S(),[p,m]=j.useState(null),{colorScheme:x}=e(),h="dark"===x;if(!n)return null;const u=i.map((e=>({value:e.id,label:`${e.name} (${e.character})`})));return l.jsxs(s,{opened:d,onClose:()=>{m(null),t()},title:l.jsx(o,{fw:700,c:h?"gray.1":"dark.8",children:"Add to Spellbook"}),overlayProps:{backgroundOpacity:.65,blur:3,color:h?"dark.8":"#e6d9c2"},children:[l.jsxs(o,{mb:"md",c:h?"gray.2":"dark.7",children:["Add ",l.jsx("strong",{children:n.spellName})," to one of your spellbooks:"]}),l.jsx(r,{data:u,placeholder:"Select a spellbook",value:p,onChange:m,clearable:!0,mb:"md",styles:{input:{backgroundColor:h?"var(--mantine-color-dark-5)":"white",borderColor:h?"var(--mantine-color-dark-4)":"var(--mantine-color-gray-4)"}}}),l.jsx(a,{onClick:()=>{if(!n||!p)return;c(p,n);const e=i.find((e=>e.id===p))?.name;y.show({title:"Spell Added",message:`${n.spellName} has been added to ${e}`,color:"green"}),m(null),t()},disabled:!p,fullWidth:!0,color:h?"blue.4":"blue.6",children:"Add to Spellbook"})]})}function z({spells:s,label:r="Export"}){const{colorScheme:t}=e(),i="dark"===t;return l.jsxs(n,{width:200,position:"bottom",withArrow:!0,shadow:"md",children:[l.jsx(n.Target,{children:l.jsx(a,{leftSection:l.jsx(v,{size:16}),variant:"outline",color:i?"blue.4":"blue.6",children:r})}),l.jsx(n.Dropdown,{bg:i?"dark.6":"white",children:l.jsxs(d,{gap:"xs",children:[l.jsx(o,{size:"sm",fw:500,c:i?"gray.1":"dark.8",children:"Export Options"}),l.jsx(a,{variant:"light",leftSection:l.jsx(C,{size:16}),onClick:()=>{w(s)},color:i?"blue.4":"blue.6",fullWidth:!0,children:"Export to PDF"})]})})]})}function A(){const{data:s,isLoading:r,error:a}=b(),[n,d]=j.useState([]),[S,y]=j.useState(null),{colorScheme:w}=e(),v="dark"===w,[C,{open:A,close:L}]=t(!1),[T,{open:$,close:D}]=t(!1);j.useEffect((()=>{s&&d(s)}),[s]);const F=e=>{y(e),A()},N=e=>{y(e),$()};return r?l.jsx(i,{h:"70vh",children:l.jsx(c,{size:"xl",color:v?"blue.4":"blue.6"})}):a?l.jsx(p,{size:"md",py:"xl",children:l.jsxs(m,{p:"xl",withBorder:!0,radius:"md",bg:v?"dark.6":"white",children:[l.jsx(x,{order:2,ta:"center",c:"red",mb:"xl",children:"Error Loading Spells"}),l.jsx(o,{ta:"center",c:v?"gray.2":"dark.7",children:a instanceof Error?a.message:"An unknown error occurred"})]})}):l.jsxs(p,{size:"xl",py:"xl",children:[l.jsxs(h,{justify:"space-between",mb:"xl",children:[l.jsx(x,{order:1,c:v?"gray.1":"dark.8",children:"Spells Library"}),l.jsx(z,{spells:n,label:"Export Spells"})]}),l.jsx(f,{spells:s||[],onFilterChange:d}),l.jsxs(o,{mt:"md",mb:"md",c:v?"gray.3":"dark.7",children:[n.length," ",1===n.length?"spell":"spells"," found"]}),l.jsx(u,{cols:{base:1,xs:2,md:3,lg:4},spacing:"md",mt:"xl",children:n.map((e=>l.jsx(k,{spell:e,onViewDetails:F,onAddToSpellbook:N},e.spellName)))}),l.jsx(g,{spell:S,opened:C,onClose:L}),l.jsx(E,{spell:S,opened:T,onClose:D})]})}export{A as default};
