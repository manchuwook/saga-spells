import{n as e,j as l,J as s,l as o,o as r,y as a,K as n,x as i,P as t,T as d,G as c,Z as p,X as m,Q as x}from"./mantine-core-BHR5fWID.js";import{l as h,h as j,r as b}from"./react-vendor-Dbzhzy_A.js";import{u as k}from"./useSpellbooks-BQRnh1fI.js";import{u,a as g,S as f,b as S}from"./SpellsFilter-BlsrBEmY.js";import{E as v}from"./EditSpellbookModal-CUnQGNl7.js";import{exportSpellbookToPDF as y}from"./pdfExport.enhanced-C6wOpqMx.js";import{c as w,d as C,i as z,g as E,j as T,e as A}from"./icons-B2NvWKa5.js";import{m as F,n as N}from"./mantine-extras-ebvNXs23.js";import"./index-DSYVc5nJ.js";import"./data-vendor-DKnsUd_z.js";import"./pdf-vendor-Dox1XW1S.js";function B({spellbook:n,label:i="Export"}){const{colorScheme:t}=e(),d="dark"===t;return l.jsxs(s,{width:200,position:"bottom",withArrow:!0,shadow:"md",children:[l.jsx(s.Target,{children:l.jsx(o,{leftSection:l.jsx(w,{size:16}),variant:"outline",color:d?"blue.4":"blue.6",children:i})}),l.jsx(s.Dropdown,{bg:d?"dark.6":"white",children:l.jsxs(r,{gap:"xs",children:[l.jsx(a,{size:"sm",fw:500,c:d?"gray.1":"dark.8",children:"Export Options"}),l.jsx(o,{variant:"light",leftSection:l.jsx(C,{size:16}),onClick:()=>{y(n)},color:d?"blue.4":"blue.6",fullWidth:!0,children:"Export to PDF"})]})})]})}function P(){const{id:s}=h(),y=j(),{getSpellbook:w,removeSpellFromSpellbook:C,addSpellToSpellbook:P}=k(),{data:R}=u(),{colorScheme:D}=e(),$="dark"===D,G=s?w(s):void 0,[M,V]=b.useState("spells"),[J,K]=b.useState(null),[L,O]=b.useState([]),[Q,{open:W,close:X}]=n(!1),[Z,{open:q,close:H}]=n(!1);if(!G)return l.jsx(i,{size:"md",py:"xl",children:l.jsxs(t,{p:"xl",withBorder:!0,radius:"md",bg:$?"dark.6":"white",children:[l.jsx(d,{order:2,ta:"center",mb:"md",c:$?"gray.1":"dark.8",children:"Spellbook Not Found"}),l.jsx(a,{ta:"center",mb:"xl",c:$?"gray.3":"dark.6",children:"The spellbook you're looking for doesn't exist or has been deleted."}),l.jsx(c,{justify:"center",children:l.jsx(o,{onClick:()=>y("/spellbooks"),color:$?"blue.4":"blue.6",children:"Back to Spellbooks"})})]})});const I=e=>{K(e),W()},U=e=>{F.openConfirmModal({title:"Remove Spell",children:l.jsxs(a,{size:"sm",children:['Are you sure you want to remove "',e,'" from this spellbook?']}),labels:{confirm:"Remove",cancel:"Cancel"},confirmProps:{color:"red"},onConfirm:()=>{s&&(C(s,e),N.show({title:"Spell Removed",message:`${e} has been removed from ${G.name}`,color:"red"}))}})},Y=e=>{s&&(P(s,e),N.show({title:"Spell Added",message:`${e.spellName} has been added to ${G.name}`,color:"green"}),V("spells"))},_=R?.filter((e=>!G.spells.some((l=>l.spellName===e.spellName))))||[];return l.jsxs(i,{size:"xl",py:"xl",children:[l.jsx(c,{mb:"md",children:l.jsx(o,{variant:"subtle",leftSection:l.jsx(z,{size:16}),onClick:()=>y("/spellbooks"),color:$?"gray.4":"dark.4",children:"Back to Spellbooks"})}),l.jsxs(c,{justify:"space-between",mb:"xl",children:[l.jsxs(r,{gap:0,children:[l.jsx(d,{order:1,c:$?"gray.1":"dark.8",children:G.name}),l.jsxs(a,{size:"lg",c:$?"gray.5":"dimmed",children:["Character: ",G.character]})]}),l.jsxs(c,{children:[l.jsx(o,{variant:"outline",leftSection:l.jsx(E,{size:16}),onClick:q,color:$?"blue.4":"blue.6",children:"Edit Spellbook"}),l.jsx(B,{spellbook:G,label:"Export Spellbook"})]})]}),G.description&&l.jsx(a,{mb:"xl",c:$?"gray.3":"dark.7",children:G.description}),l.jsxs(p,{value:M,onChange:V,styles:{tab:{color:$?"var(--mantine-color-gray-4)":"var(--mantine-color-dark-6)","&[data-active]":{color:$?"var(--mantine-color-blue-4)":"var(--mantine-color-blue-6)"}}},children:[l.jsxs(p.List,{mb:"xl",children:[l.jsxs(p.Tab,{value:"spells",leftSection:l.jsx(T,{size:16}),children:["Spellbook Contents (",G.spells.length,")"]}),l.jsx(p.Tab,{value:"add-spells",leftSection:l.jsx(A,{size:16}),children:"Add Spells"})]}),l.jsx(p.Panel,{value:"spells",children:0===G.spells.length?l.jsxs(m,{withBorder:!0,p:"xl",ta:"center",bg:$?"dark.6":"white",children:[l.jsx(a,{size:"lg",fw:500,mb:"md",c:$?"gray.1":"dark.8",children:"This spellbook is empty"}),l.jsx(a,{mb:"xl",c:$?"gray.3":"dark.6",children:'Go to the "Add Spells" tab to start adding spells to this spellbook.'}),l.jsx(o,{onClick:()=>V("add-spells"),color:$?"blue.4":"blue.6",children:"Add Spells"})]}):l.jsx(x,{cols:{base:1,xs:2,md:3,lg:4},spacing:"md",children:G.spells.map((e=>l.jsx(g,{spell:e,onViewDetails:I,onRemoveFromSpellbook:U,showRemoveButton:!0},e.spellName)))})}),l.jsx(p.Panel,{value:"add-spells",children:l.jsxs(r,{gap:"lg",children:[l.jsx(f,{spells:_,onFilterChange:O}),l.jsxs(a,{c:$?"gray.3":"dark.7",children:[L.length," available ",1===L.length?"spell":"spells"]}),l.jsx(x,{cols:{base:1,xs:2,md:3,lg:4},spacing:"md",children:L.map((e=>l.jsx(g,{spell:e,onViewDetails:I,onAddToSpellbook:Y},e.spellName)))})]})})]}),l.jsx(S,{spell:J,opened:Q,onClose:X}),l.jsx(v,{spellbook:G,opened:Z,onClose:H})]})}export{P as default};
